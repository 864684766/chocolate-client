"use strict";const e=require("electron"),o=require("path"),d=require("url"),a=require("fs");var r=typeof document<"u"?document.currentScript:null,c={};const l=d.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:r&&r.tagName.toUpperCase()==="SCRIPT"&&r.src||new URL("main/index.cjs",document.baseURI).href),i=o.dirname(l),p="Chocolate Client",u=!e.app.isPackaged;function f(){if(c.VITE_DEV_PORT)return c.VITE_DEV_PORT;const n=o.join(i,"../.vite-port");if(a.existsSync(n))try{const t=a.readFileSync(n,"utf-8").trim();if(t)return t}catch(t){console.warn(`Failed to read port file: ${t}`)}return"5173"}const h=f();function s(){const n=new e.BrowserWindow({width:1200,height:800,minWidth:800,minHeight:600,title:p,webPreferences:{preload:o.join(i,"../preload/index.cjs"),contextIsolation:!0,sandbox:!0,nodeIntegration:!1,webSecurity:!0}});return u?(n.loadURL(`http://localhost:${h}`),n.webContents.openDevTools()):n.loadFile(o.join(i,"../dist/index.html")),n}function m(){s()}function w(){process.platform!=="darwin"&&e.app.quit()}function _(){e.BrowserWindow.getAllWindows().length===0&&s()}function g(){e.ipcMain.handle("app:getVersion",()=>e.app.getVersion()),e.ipcMain.handle("app:getPlatform",()=>process.platform)}e.app.whenReady().then(()=>{g(),m()});e.app.on("window-all-closed",w);e.app.on("activate",_);
